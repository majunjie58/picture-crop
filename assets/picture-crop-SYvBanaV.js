import{r as d,c as U,a as n,w as c,b as i,d as k,e as x,t as L,M as j,o as C}from"./index-CFBLOis-.js";const N={class:"app"},I={__name:"picture-crop",setup(B){const p=d(""),r=d(3200),_=d([]),v=d(null),h=t=>t.toString().padStart(4,"0"),y=t=>{_.value=t.target.files},V=async()=>{const t=_.value;for(let e=0;e<t.length;e++){const u=t[e],m=new FileReader;m.readAsDataURL(u);let f=await new Promise(o=>{m.onload=w=>{o(w.target.result)}});const l=new Image;l.src=f,await new Promise(o=>{l.onload=()=>{o()}});const a=document.createElement("canvas");a.width=1350,a.height=1800;let s=l.width-40,R=s*1800/1350;a.getContext("2d").drawImage(l,0,0,s,R,0,0,a.width,a.height),await new Promise(o=>{setTimeout(o,100)});let P=h(e+r.value);await new Promise(o=>{a.toBlob(w=>{const b=URL.createObjectURL(w),g=document.createElement("a");g.href=b,g.download=`${p.value}-${P}.jpg`,g.click(),URL.revokeObjectURL(b),o()},"image/jpeg",.9)})}r.value+=t.length,_.value=[],v.value=null,j.success(`处理完成，共处理 ${t.length} 张图片`)};return(t,e)=>{const u=i("a-form-item"),m=i("a-input-number"),f=i("a-input"),l=i("a-button"),a=i("a-form");return C(),U("div",N,[n(a,{class:"form","auto-label-width":"",model:{},style:{width:"400px"}},{default:c(()=>[n(u,{label:"选取图片"},{default:c(()=>[k("input",{ref_key:"inputRef",ref:v,type:"file",accept:"image/*",multiple:"",onChange:y},null,544)]),_:1}),n(u,{label:"起始数字"},{default:c(()=>[n(m,{modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=s=>r.value=s),style:{width:"100px"}},null,8,["modelValue"])]),_:1}),n(u,{label:"名称前缀"},{default:c(()=>[n(f,{modelValue:p.value,"onUpdate:modelValue":e[1]||(e[1]=s=>p.value=s),style:{width:"100px"}},null,8,["modelValue"]),x("-"+L(h(r.value))+".jpg ",1)]),_:1}),n(l,{type:"primary",onClick:V},{default:c(()=>[...e[2]||(e[2]=[x("开始处理",-1)])]),_:1})]),_:1})])}}};export{I as default};
